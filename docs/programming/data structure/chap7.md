# 第七章 查找
- 基本概念
    - 查找
    - 查找表
        - 用于查找的数据集合
    - 静态查找表
        - 操作只涉及查询检索，无需动态修改查找表
    - 动态查找表
        - 需要动态插入或删除的查找表
    - 关键字
        - 数据元素中唯一标识该元素的某个数据项的值
    - 静态查找
    - 动态查找
    - 平均查找长度 ASL
        - 查找过程中比较次数的平均值
        - 是查找算法效率指标
        - 查找成功情况下
        - 查找失败情况下
- 线性结构
    - 顺序查找  含哨兵 ![图片](./第七章 查找-幕布图片-161128-439081.jpg)
        - ASL
            - 成功
            - 失败
        - 优化
            - 让关键字有序，降低查找失败的ASL
            - 让关键字按被查找概率从大到小排序，降低查找成功的ASL
    - 折半查找  升序 ![图片](./第七章 查找-幕布图片-558401-240416.jpg)
        - 只适用于有序的顺序表
        - 折半查找判定树
            - 前提：mid向下取整
            - 右子树结点数-左子树结点数=0或1
                - 左比右少
            - 画法：先放右子树，一行满了再放左子树，从右往左放
            - 树高和完全二叉树一致
                - 只有最下面一层不满
                - 树高决定了折半查找时间复杂度O(logn)
            - 成功节点数n，失败节点数（空链域数）为n+1
        - 折半查找速度大多数情况下比顺序查找快，不是一定
    - 分块查找 ![图片](./第七章 查找-幕布图片-942168-484942.jpg)
        - 索引顺序查找
        - 将查找表分为若干子块
            - 块内无序，块间有序
        - 建立索引表，每个元素是所对应块内元素的最大值
        - 过程
            - 查找索引表确定块（索引大于等于目标），可用顺序和二分
            - 块内顺序查找
        - 折半查找索引表时，目标不在索引内，最终low›high，在low所指块中查找
        - ASL
            - 索引表ASL+块内ASL
            - 规则情况
                - 长度为n的查找表，均匀分为b块，每块s个记录
                - 索引顺序
                    - ASL=(b+1)/2+(s+1)/2
                    - s=sqrt(n)时ASL最小，为sqrt(n)-1
                - 索引二分
                    - ASL=上取整(log2(b+1))+(s+1)/2
- 树形结构
    - 二叉排序树
    - 二叉平衡树
    - 红黑树
    - <font color=#DC2D1E>B树</font> <font color=#75C940>多路平衡查找树</font>
        - 所有结点到孩子个数的最大值为阶数，记为m
        - m阶B树满足的特性
            - <font color=#75C940>每个结点</font> <font color=#FFAF38>至多</font> 有 <font color=#75C940>m棵子树，</font> 含有 <font color=#75C940>m-1个关键字</font>
            - 若 <font color=#75C940>根结点</font> 不是终端结点，则至少有两颗子树 <font color=#75C940>绝对平衡</font>
                - 任意结点子树高度相同
            - 除根结点以外所有非叶结点至少m/2向上取整棵子树
                - <font color=#FFAF38>至少</font> <font color=#75C940>含有m/2向上取整-1个关键字</font>
                - 保证每个结点不会太空，以至于退化成二叉树
            - 所有叶节点在同一层次上，不带信息
                - 可视为外部结点或查找失败结点
                - 实际上这些结点不存在，指向这些结点的指针为空
        - <font color=#DC2D1E>B树的高度</font>
            - 含n个关键字的m阶B树
            - 最小高度
                - 每个结点尽可能被填满
                - 每个结点m-1个关键字
                - 有 1+m+m^2+...+m^(h-1)个结点
                - (m-1 )1+m+m^2+...+m^(h-1)=m^h-1
            - 最大高度 ![图片](./第七章 查找-幕布图片-818754-103351.jpg)
                - n个关键字的B树必有n+1个叶子结点
        - <font color=#40A8F5>查找过程</font>
        - <font color=#40A8F5>插入过程</font>
            - 插入新关键字后导致原 <font color=#FFAF38>结点关键字数超过上限</font>
                - 从中间位置  m/2向上取整  处分开
                - 分为左右两部分，中间位置关键字插入原结点的父节点中
                - 若导致其父节点关键字数超过上限，则父节点也执行该操作
        - <font color=#40A8F5>删除过程</font>
            - 对于非终端结点
                - 可以通过让其直接前驱或直接后继代替其位置转化为删除终端节点
            - 删除关键字在终端结点
                - 直接删除
                - 兄弟够借
                    - 右够   后继和后继的后继依次移动
                    - 左够   前驱和前驱的前驱一次移动
                - 兄弟不够借
                    - 与左或右兄弟结点以及父节点结点中的关键字进行合并
                    - 可能会产生连锁反应，要检查父节点，逐层向上
    - B+树
        - 对比分块查找
        - 应数据库所需而出现
        - 满足的特性
            - 每个分支结点最多m棵子树
            - 非根结点至少有两颗子树，每个分支结点至少有m/2向上取整
            - <font color=#DC2D1E>结点的子树个数与关键字个数相等</font>
                - B树是插空
            - 所有叶结点包含全部关键字，相邻叶结点按大小顺序相互链接起来
            - 所有分支结点包含它子结点中 <font color=#FFAF38>最大</font> 的关键字
        - 查找
            - 从根
                - 无论查找成功与否，都要走到最下面一层
            - 顺序查找
                - 叶结点从头按索引顺序查找
    - <font color=#FFAF38>B树与B+树的差异</font>
        - 分叉和关键字数量
            - B+树
                - n个关键字对应n棵子树
                - 根节点
                - 其他结点 ![图片](./第七章 查找-幕布图片-915916-936421.jpg)
            - B树  n个关键字对应n-1棵子树 ![图片](./第七章 查找-幕布图片-660530-341672.jpg)
        - 关键字
            - B树 各结点中包含的关键字不重复
            - B+树 叶节点包含全部关键字
        - 关键字记录
            - B树  结点中都包含了关键字对应的记录的存储地址
            - B+树 叶结点包含关键字记录信息，所有非叶结点仅起了索引作用
        - 查找时
            - B树查找成功可以停在任意一层
            - B+树无论查找成功与否，都要走到最下面一层
        -  ![图片](./第七章 查找-幕布图片-707130-89359.jpg)
    - 扩展应用 ![图片](./第七章 查找-幕布图片-978173-630583.jpg) ![图片](./第七章 查找-幕布图片-30256-959243.jpg)
- 散列结构
    - 基本概念
        - 散列函数
        - 冲突
        - 同义词
        - 散列表
    - 散列函数构造方法
        - 直接定值法
            - 适合关键字分布连续，例如学号
        - 除留余数法
            - 用质数取模，分布更均匀，冲突更少
            - 取小于等于散列表表长m的最大质数
        - 数字分析法
            - 取关键字数字分布均匀的几位，例如手机号后四位
        - 平方取中法
            - 将关键字平方后取中间和各位都有关系的几位
    - 处理冲突的方法
        - 开放定址法
            - 线性探测法
                - 易堆积
                - 堆积（聚集）：非同义词之间争夺一个地址的情况
            - 平方探测法
                - 避免堆积，但不能探测到散列表上所有单元
                - 散列表长度m必须为可以表示成4k+3的素数
            - 再散列法
                - 多个散列函数，在第一个散列函数映射的位置产生冲突后采用下一个函数继续进行散列
            - 伪随机序列法
            - （删除时不能直接删除，应该做标记，逻辑上删除）
            - 探测法在超出散列表长度后由于取模的原因，会从另一头继续开始探测
        - 拉链法
            - 不会堆积
    - 性能分析 <font color=#40A8F5>用空间换时间</font>
- 效率指标
    - 三因素
        - 散列函数
            - 足够好的散列函数（哈希函数）可以使查找效率达到O(1)
        - 处理冲突方法
        - 装填因子
            - 表中记录个数/散列表表长
            - 越大装的越满，越容易产生冲突
    - 平均查找长度
        - 成功
        - 不成功
        - 探测法
        - 拉链法